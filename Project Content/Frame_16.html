<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" type="image/png" href="UMak_Logo_Registered.png" />
  <title>University of Makati Library - Report Noise</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="theme.css" />
  <script defer src="theme.js"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <style>
    /* Modern Top Navigation Bar */
    .modern-sidebar {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: auto;
      min-width: 320px;
      max-width: 500px;
      height: auto;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-top: none;
      border-radius: 0 0 20px 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(255, 255, 255, 0.05);
      z-index: 1000;
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      padding: 1rem 2rem;
      gap: 1rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Top Navigation Items */
    .sidebar-nav-item {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(0, 0, 0, 0.3);
      color: #374151;
      text-decoration: none;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
    }

    .sidebar-nav-item:hover {
      transform: translateY(-2px) scale(1.05);
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(0, 0, 0, 0.5);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15), 0 0 20px rgba(59, 130, 246, 0.3);
    }

    .sidebar-nav-item:active {
      transform: translateY(0) scale(0.98);
    }

    .sidebar-nav-item.active {
      background: rgba(59, 130, 246, 0.2);
      border-color: rgba(59, 130, 246, 0.4);
      color: #3b82f6;
    }

    /* Sidebar Icons */
    .sidebar-icon {
      width: 24px;
      height: 24px;
      stroke-width: 1.5;
    }

    /* Tooltips */
    .sidebar-tooltip {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      margin-top: 0.5rem;
      padding: 0.5rem 0.75rem;
      background: rgba(0, 0, 0, 0.9);
      color: white;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 500;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: none;
      z-index: 1001;
    }

    .sidebar-tooltip::before {
      content: '';
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-bottom-color: rgba(0, 0, 0, 0.9);
    }

    .sidebar-nav-item:hover .sidebar-tooltip {
      opacity: 1;
      visibility: visible;
    }

    /* Logo/Brand in Top Navigation */
    .sidebar-brand {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 0.5rem;
    }

    .sidebar-brand img {
      width: 32px;
      height: 32px;
      border-radius: 6px;
    }

    .sidebar-brand-text {
      font-size: 1.125rem;
      font-weight: 600;
      color: #374151;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .modern-sidebar {
        min-width: 280px;
        max-width: 90vw;
        padding: 0.75rem 1rem;
        gap: 0.75rem;
      }

      .sidebar-nav-item {
        width: 40px;
        height: 40px;
      }

      .sidebar-icon {
        width: 20px;
        height: 20px;
      }

      .sidebar-brand img {
        width: 28px;
        height: 28px;
      }

      .sidebar-brand-text {
        font-size: 1rem;
      }
    }

    /* Dark Mode Support */
    @media (prefers-color-scheme: dark) {
      .modern-sidebar {
        background: rgba(15, 23, 42, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-top: none;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.05);
      }

      .sidebar-nav-item {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: #e5e7eb;
      }

      .sidebar-nav-item:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3), 0 0 20px rgba(59, 130, 246, 0.4);
      }

      .sidebar-nav-item.active {
        background: rgba(59, 130, 246, 0.3);
        border-color: rgba(59, 130, 246, 0.5);
        color: #60a5fa;
      }

      .sidebar-brand-text {
        color: #e5e7eb;
      }
    }

    /* Manual dark mode class support */
    .dark .modern-sidebar {
      background: rgba(15, 23, 42, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-top: none;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.05);
    }

    .dark .sidebar-nav-item {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #e5e7eb;
    }

    .dark .sidebar-nav-item:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3), 0 0 20px rgba(59, 130, 246, 0.4);
    }

    .dark .sidebar-nav-item.active {
      background: rgba(59, 130, 246, 0.3);
      border-color: rgba(59, 130, 246, 0.5);
      color: #60a5fa;
    }

    .dark .sidebar-brand-text {
      color: #e5e7eb;
    }

    /* Adjust main content for top navigation */
    .main-with-sidebar {
      padding-top: 5rem;
    }
  </style>
  <script>
    // Language translations
    const translations = {
      en: {
        home: "Home",
        register: "Register",
        howToHelp: "How To / Help",
        settings: "Settings",
        profile: "Profile",
        map: "Map",
        report: "Report",
        logout: "Logout",
        reportNoise: "Report Noise",
        noiseReport: "Noise Report",
        reportNoiseLevel: "Report Noise Level",
        selectNoiseLevel: "Select Noise Level",
        quiet: "Quiet",
        moderate: "Moderate",
        noisy: "Noisy",
        veryNoisy: "Very Noisy",
        addComment: "Add Comment (Optional)",
        submitReport: "Submit Report",
        communityReports: "Community Reports",
        adminReports: "Admin Reports",
        librarySystem: "University of Makati Library",
        noiseComfort: "Noise Comfort Index"
      },
      fil: {
        home: "Tahanan",
        register: "Magparehistro",
        howToHelp: "Paano / Tulong",
        settings: "Mga Setting",
        profile: "Profile",
        map: "Mapa",
        report: "Mag-report",
        logout: "Mag-logout",
        reportNoise: "Mag-report ng Ingay",
        noiseReport: "Report ng Ingay",
        reportNoiseLevel: "Mag-report ng Antas ng Ingay",
        selectNoiseLevel: "Piliin ang Antas ng Ingay",
        quiet: "Tahimik",
        moderate: "Katamtaman",
        noisy: "Maingay",
        veryNoisy: "Napakaingay",
        addComment: "Magdagdag ng Komento (Opsiyonal)",
        submitReport: "I-submit ang Report",
        communityReports: "Mga Report ng Komunidad",
        adminReports: "Mga Report ng Admin",
        librarySystem: "Aklatan ng University of Makati",
        noiseComfort: "Index ng Kaginhawahan sa Ingay"
      }
    };

    // Function to update page language
    function updateLanguage(language) {
      const t = translations[language];
      if (!t) return;

      // Update all text elements
      const elements = {
        'home-tooltip': t.home,
        'register-tooltip': t.register,
        'help-tooltip': t.howToHelp,
        'settings-tooltip': t.settings,
        'report-noise-title': t.reportNoise,
        'noise-report-title': t.noiseReport,
        'report-noise-level': t.reportNoiseLevel,
        'select-noise-level': t.selectNoiseLevel,
        'quiet-label': t.quiet,
        'moderate-label': t.moderate,
        'noisy-label': t.noisy,
        'very-noisy-label': t.veryNoisy,
        'add-comment-label': t.addComment,
        'submit-report-btn': t.submitReport,
        'community-reports-title': t.communityReports,
        'admin-reports-title': t.adminReports,
        'profile-tooltip': t.profile,
        'map-tooltip': t.map,
        'report-tooltip': t.report,
        'logout-btn': t.logout,
        'library-title': t.librarySystem,
        'footer-text': t.noiseComfort
      };

      // Update text content
      Object.entries(elements).forEach(([id, text]) => {
        const element = document.getElementById(id);
        if (element) {
          element.textContent = text;
        }
      });
    }

    // Load saved language and apply it
    document.addEventListener('DOMContentLoaded', function () {
      const savedLanguage = localStorage.getItem('language');
      if (savedLanguage) {
        updateLanguage(savedLanguage);
      }
    });
  </script>
  <!-- UI/UX refinements (non-breaking):
       - improved padding and spacing consistency across sections
       - fixed low-contrast text by mapping to theme tokens
       - unified card/option hover & selected states with brand color
       - replaced hard dividers with spacing for cleaner separation
       - responsive tweaks for mobile readability and hierarchy -->
  <style>
    /* Global fade-in like Frame 15 */
    [data-fade] {
      opacity: 0;
      --fade-init: 14px;
      --fade-filter: none;
      filter: var(--fade-filter) !important;
      transition: var(--fade-transition, opacity 1000ms ease-out, filter 1000ms ease-out) !important;
      will-change: opacity, filter;
    }

    [data-fade]:not([data-blur="false"]) {
      --fade-filter: blur(var(--fade-init));
    }

    /* Library-themed cursor follower - subtle and calm */
    .cursor-follower {
      position: fixed;
      top: 0;
      left: 0;
      width: 100px;
      height: 100px;
      border-radius: 50%;
      pointer-events: none;
      transform: translate(-50%, -50%) scale(1);
      transition: opacity 200ms ease-out;
      will-change: transform, opacity;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      background: radial-gradient(circle, rgba(0, 0, 0, 0.15) 0%, rgba(0, 0, 0, 0.05) 50%, rgba(0, 0, 0, 0.02) 100%);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.2);
      opacity: 0;
      z-index: 1;
      /* Behind text and UI elements */
    }

    /* Dark mode - keep white cursor follower */
    @media (prefers-color-scheme: dark) {
      .cursor-follower {
        background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 50%, rgba(255, 255, 255, 0.02) 100%);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.2);
      }
    }

    /* Manual dark mode class support */
    .dark .cursor-follower {
      background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 50%, rgba(255, 255, 255, 0.02) 100%);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    /* Hide on small screens and touch devices */
    @media (max-width: 640px) {
      .cursor-follower {
        display: none;
      }
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce) {
      .cursor-follower {
        display: none !important;
      }
    }

    /* Enhanced card styles for modern, student-friendly design */
    .card {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 1.25rem;
      box-shadow:
        0 2px 8px rgba(0, 0, 0, 0.08),
        0 1px 3px rgba(0, 0, 0, 0.05);
      padding: 1.5rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
      position: relative;
      overflow: hidden;
      will-change: transform, box-shadow;
      transform: translateZ(0);
      cursor: pointer;
    }

    /* Touch device support */
    @media (hover: none) and (pointer: coarse) {
      .card:active {
        transform: translateY(-2px) translateZ(0) !important;
        box-shadow:
          0 8px 25px rgba(0, 0, 0, 0.15),
          0 4px 12px rgba(0, 0, 0, 0.1),
          0 2px 6px rgba(0, 0, 0, 0.05) !important;
        border-color: rgba(59, 130, 246, 0.3) !important;
        background: rgba(255, 255, 255, 0.98) !important;
        z-index: 10 !important;
      }
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
      transform: translateZ(0);
    }

    .card:hover {
      transform: translateY(-3px) translateZ(0) !important;
      box-shadow:
        0 12px 35px rgba(0, 0, 0, 0.2),
        0 6px 20px rgba(0, 0, 0, 0.15),
        0 3px 10px rgba(0, 0, 0, 0.1),
        0 0 0 1px rgba(59, 130, 246, 0.1) !important;
      border-color: rgba(59, 130, 246, 0.3) !important;
      background: rgba(255, 255, 255, 0.98) !important;
      z-index: 10 !important;
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--text-primary, #1e293b);
      letter-spacing: -0.025em;
      line-height: 1.3;
    }

    .meta {
      color: var(--text-secondary, #64748b);
      font-size: 0.875rem;
      font-weight: 500;
      opacity: 0.8;
    }

    /* Enhanced button styles */
    .btn-outline {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.25);
      color: var(--text-primary, #1e293b);
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
      will-change: background-color, border-color, transform;
      transform: translateZ(0);
    }

    .btn-outline:hover {
      background: rgba(255, 255, 255, 0.25);
      border-color: rgba(255, 255, 255, 0.35);
      transform: translateY(-2px) translateZ(0) !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    }

    /* Enhanced form elements */
    .noise-level-option,
    .urgency-option {
      transition: transform 0.15s ease-out, box-shadow 0.15s ease-out;
      will-change: transform, box-shadow;
    }

    .noise-level-option:hover,
    .urgency-option:hover {
      transform: translateY(-1px) translateZ(0);
    }

    /* Enhanced select and input elements */
    select,
    input,
    textarea {
      transition: border-color 0.15s ease-out, box-shadow 0.15s ease-out;
      will-change: border-color, box-shadow;
    }

    /* Dark mode support for enhanced cards */
    @media (prefers-color-scheme: dark) {
      .card {
        background: rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.15);
        box-shadow:
          0 2px 8px rgba(0, 0, 0, 0.25),
          0 1px 3px rgba(0, 0, 0, 0.15);
      }

      .card::before {
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      }

      .card:hover {
        transform: translateY(-3px) translateZ(0) !important;
        box-shadow:
          0 12px 35px rgba(0, 0, 0, 0.5),
          0 6px 20px rgba(0, 0, 0, 0.4),
          0 3px 10px rgba(0, 0, 0, 0.3),
          0 0 0 1px rgba(59, 130, 246, 0.2) !important;
        border-color: rgba(59, 130, 246, 0.4) !important;
        background: rgba(15, 23, 42, 0.98) !important;
        z-index: 10 !important;
      }

      /* Touch device support for dark mode */
      @media (hover: none) and (pointer: coarse) {
        .card:active {
          transform: translateY(-2px) translateZ(0) !important;
          box-shadow:
            0 8px 25px rgba(0, 0, 0, 0.4),
            0 4px 12px rgba(0, 0, 0, 0.3),
            0 2px 6px rgba(0, 0, 0, 0.2) !important;
          border-color: rgba(59, 130, 246, 0.4) !important;
          background: rgba(15, 23, 42, 0.98) !important;
          z-index: 10 !important;
        }
      }

      .btn-outline {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--text-primary, #f1f5f9);
      }

      .btn-outline:hover {
        background: rgba(255, 255, 255, 0.2);
        border-color: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px) translateZ(0) !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
      }
    }

    /* Manual dark mode class support */
    .dark .card {
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow:
        0 2px 8px rgba(0, 0, 0, 0.25),
        0 1px 3px rgba(0, 0, 0, 0.15);
    }

    .dark .card::before {
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    }

    .dark .card:hover {
      transform: translateY(-3px) translateZ(0) !important;
      box-shadow:
        0 12px 35px rgba(0, 0, 0, 0.5),
        0 6px 20px rgba(0, 0, 0, 0.4),
        0 3px 10px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(59, 130, 246, 0.2) !important;
      border-color: rgba(59, 130, 246, 0.4) !important;
      background: rgba(15, 23, 42, 0.98) !important;
      z-index: 10 !important;
    }

    .dark .btn-outline {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: var(--text-primary, #f1f5f9);
    }

    .dark .btn-outline:hover {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px) translateZ(0) !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
    }

    /* Respect reduced motion for all enhanced elements */
    @media (prefers-reduced-motion: reduce) {
      .card {
        transition: none !important;
      }

      .card:hover {
        transform: none !important;
      }

      .btn-outline {
        transition: none !important;
      }

      .btn-outline:hover {
        transform: none !important;
      }

      .noise-level-option,
      .urgency-option {
        transition: none !important;
      }

      .noise-level-option:hover,
      .urgency-option:hover {
        transform: none !important;
      }

      select,
      input,
      textarea {
        transition: none !important;
      }
    }

    /* Confirmation Modal Styles */
    .confirmation-modal-overlay {
      position: fixed;
      inset: 0;
      background-color: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 1rem;
    }

    .confirmation-modal {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 1.25rem;
      box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.2),
        0 4px 16px rgba(0, 0, 0, 0.1);
      max-width: 500px;
      width: 100%;
      overflow: hidden;
      transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
      will-change: transform;
      transform: translateZ(0);
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .confirmation-modal-header {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
      padding: 1.5rem;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .confirmation-modal-header svg {
      width: 32px;
      height: 32px;
      flex-shrink: 0;
    }

    .confirmation-modal-header h3 {
      font-size: 1.25rem;
      font-weight: 600;
      margin: 0;
    }

    .confirmation-modal-body {
      padding: 1.5rem;
      color: #334155;
      line-height: 1.6;
    }

    .confirmation-modal-body p {
      margin: 0 0 1rem 0;
    }

    .confirmation-modal-body .warning-text {
      background: #fef2f2;
      border-left: 4px solid #ef4444;
      padding: 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      color: #991b1b;
      margin-top: 1rem;
    }

    .confirmation-modal-footer {
      padding: 1rem 1.5rem;
      background: #f8fafc;
      display: flex;
      gap: 0.75rem;
      justify-content: flex-end;
      flex-wrap: wrap;
    }

    .confirmation-modal-footer button {
      padding: 0.625rem 1.5rem;
      border-radius: 0.5rem;
      font-weight: 500;
      transition: all 0.2s ease;
      cursor: pointer;
      border: none;
      font-size: 0.875rem;
    }

    .confirmation-modal-footer .btn-cancel {
      background: white;
      color: #64748b;
      border: 1px solid #cbd5e1;
    }

    .confirmation-modal-footer .btn-cancel:hover {
      background: #f1f5f9;
      border-color: #94a3b8;
    }

    .confirmation-modal-footer .btn-confirm {
      background: #ef4444;
      color: white;
    }

    .confirmation-modal-footer .btn-confirm:hover {
      background: #dc2626;
    }

    @media (max-width: 640px) {
      .confirmation-modal-header h3 {
        font-size: 1.125rem;
      }

      .confirmation-modal-footer {
        flex-direction: column-reverse;
      }

      .confirmation-modal-footer button {
        width: 100%;
      }
    }

    /* Dark mode support for confirmation modal */
    @media (prefers-color-scheme: dark) {
      .confirmation-modal {
        background: rgba(15, 23, 42, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.15);
        box-shadow:
          0 8px 32px rgba(0, 0, 0, 0.4),
          0 4px 16px rgba(0, 0, 0, 0.2);
      }
    }

    .dark .confirmation-modal {
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.4),
        0 4px 16px rgba(0, 0, 0, 0.2);
    }

    /* Content Validation Warning Styles */
    .validation-warning {
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-left: 4px solid #ef4444;
      border-radius: 0.5rem;
      padding: 1rem;
      margin-top: 0.75rem;
      display: none;
      animation: slideIn 0.3s ease-out;
    }

    .validation-warning.show {
      display: block;
    }

    .validation-warning-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .validation-warning-icon {
      width: 20px;
      height: 20px;
      color: #ef4444;
      flex-shrink: 0;
    }

    .validation-warning-title {
      font-weight: 600;
      color: #991b1b;
      font-size: 0.875rem;
    }

    .validation-warning-message {
      color: #991b1b;
      font-size: 0.875rem;
      line-height: 1.5;
    }

    .validation-warning-actions {
      margin-top: 0.75rem;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .validation-warning-actions button {
      padding: 0.375rem 0.75rem;
      border-radius: 0.375rem;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }

    .validation-warning-actions .btn-edit {
      background: #ef4444;
      color: white;
    }

    .validation-warning-actions .btn-edit:hover {
      background: #dc2626;
    }

    .validation-warning-actions .btn-dismiss {
      background: #f3f4f6;
      color: #6b7280;
      border: 1px solid #d1d5db;
    }

    .validation-warning-actions .btn-dismiss:hover {
      background: #e5e7eb;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Highlight invalid text */
    .textarea-invalid {
      border-color: #ef4444 !important;
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
    }

    @media (max-width: 640px) {
      .validation-warning-actions {
        flex-direction: column;
      }

      .validation-warning-actions button {
        width: 100%;
      }
    }

    /* Library background with blur effect */
    .library-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #f0f0f0;
      /* Fallback color in case image doesn't load */
      background-image: url('librarybg.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      filter: blur(6px);
      -webkit-filter: blur(6px);
      transform: scale(1.05);
      /* Slightly larger to hide blur edges */
      pointer-events: none;
      opacity: 0.7;
      /* Make background darker by reducing opacity */
      z-index: -2;
    }

    /* Dark mode support for library background */
    @media (prefers-color-scheme: dark) {
      .library-background {
        filter: blur(6px) brightness(0.7);
        -webkit-filter: blur(6px) brightness(0.7);
      }
    }

    /* Manual dark mode class support */
    .dark .library-background {
      filter: blur(6px) brightness(0.7);
      -webkit-filter: blur(6px) brightness(0.7);
    }

    /* Override theme.css and Tailwind body background to show library background */
    body.bg-slate-50 {
      background-color: transparent !important;
    }

    body {
      background-color: transparent !important;
    }

    /* Enhanced footer with frosted glass effect */
    .footer-glass {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
      color: #374151;
      font-weight: 500;
    }

    /* Dark mode footer */
    @media (prefers-color-scheme: dark) {
      .footer-glass {
        background: rgba(15, 23, 42, 0.85);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        color: #e5e7eb;
      }
    }

    /* Manual dark mode class support */
    .dark .footer-glass {
      background: rgba(15, 23, 42, 0.85);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
      color: #e5e7eb;
    }
  </style>
</head>

<body class="bg-slate-50 text-slate-900 min-h-screen flex flex-col">
  <div id="cursor-follower" class="cursor-follower" aria-hidden="true"></div>
  <div id="library-background" class="library-background" aria-hidden="true"></div>
  <!-- Modern Top Navigation Bar -->
  <nav class="modern-sidebar" data-fade data-blur="true" data-initial-opacity="0" data-duration="1000">
    <!-- Brand/Logo -->
    <div class="sidebar-brand">
      <img src="UMak_Logo_Registered.png" alt="University of Makati Logo" />
    </div>

    <!-- Navigation Items -->
    <a href="Frame_11.html" class="sidebar-nav-item" aria-label="Profile">
      <i data-lucide="user" class="sidebar-icon"></i>
      <div class="sidebar-tooltip" id="profile-tooltip">Profile</div>
    </a>

    <a href="Frame_8.html" class="sidebar-nav-item" aria-label="Map">
      <i data-lucide="map" class="sidebar-icon"></i>
      <div class="sidebar-tooltip" id="map-tooltip">Map</div>
    </a>

    <a href="Frame_16.html" class="sidebar-nav-item active" aria-label="Report">
      <i data-lucide="flag" class="sidebar-icon"></i>
      <div class="sidebar-tooltip" id="report-tooltip">Report</div>
    </a>

    <button id="logoutBtn" class="sidebar-nav-item" aria-label="Logout">
      <i data-lucide="log-out" class="sidebar-icon"></i>
      <div class="sidebar-tooltip" id="logout-btn">Logout</div>
    </button>
  </nav>

  <main class="main-with-sidebar flex-1 flex items-start justify-center py-12 px-6" data-fade data-blur="true"
    data-initial-opacity="0" data-duration="1000" data-delay="50">
    <div class="w-full max-w-4xl">

      <!-- Report Header -->
      <section class="card mb-6" data-fade data-blur="true" data-duration="900" data-easing="ease-out" data-delay="0"
        data-initial-opacity="0">
        <div class="flex items-start gap-4">
          <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center order-1 ml-[5px]">
            <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z">
              </path>
            </svg>
          </div>
          <div class="flex-1 order-2" data-fade data-blur="true" data-delay="50" data-initial-opacity="0">
            <h1 id="report-noise-title" class="card-title">Report Noise Disturbance</h1>
            <p class="meta">Help maintain a quiet study environment by reporting noise issues. Your reports
              help librarians take appropriate action.</p>
            <p class="text-xs text-slate-500 mt-1">Note: Once a librarian resolves your complaint, it will be removed
              from your recent reports list.</p>
          </div>
        </div>
      </section>

      <!-- Noise Report Form -->
      <section class="card mb-6" data-fade data-blur="true" data-duration="950" data-easing="ease-out" data-delay="75"
        data-initial-opacity="0">
        <form id="noiseReportForm" class="space-y-6">
          <!-- Noise Level -->
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-3">Noise Level</label>
            <div class="grid grid-cols-3 md:grid-cols-5 gap-2 sm:gap-3">
              <label class="relative cursor-pointer">
                <input type="radio" name="noiseLevel" value="1" class="sr-only" />
                <div
                  class="noise-level-option p-3 rounded-lg border-2 border-slate-200 text-center hover:border-green-300 transition">
                  <div class="text-lg mb-1">🔇</div>
                  <div class="text-xs font-medium">Quiet</div>
                  <div class="text-xs text-slate-500">Level 1</div>
                </div>
              </label>
              <label class="relative cursor-pointer">
                <input type="radio" name="noiseLevel" value="2" class="sr-only" />
                <div
                  class="noise-level-option p-3 rounded-lg border-2 border-slate-200 text-center hover:border-green-300 transition">
                  <div class="text-lg mb-1">🔉</div>
                  <div class="text-xs font-medium">Low</div>
                  <div class="text-xs text-slate-500">Level 2</div>
                </div>
              </label>
              <label class="relative cursor-pointer">
                <input type="radio" name="noiseLevel" value="3" class="sr-only" />
                <div
                  class="noise-level-option p-3 rounded-lg border-2 border-slate-200 text-center hover:border-yellow-300 transition">
                  <div class="text-lg mb-1">🔊</div>
                  <div class="text-xs font-medium">Moderate</div>
                  <div class="text-xs text-slate-500">Level 3</div>
                </div>
              </label>
              <label class="relative cursor-pointer">
                <input type="radio" name="noiseLevel" value="4" class="sr-only" />
                <div
                  class="noise-level-option p-3 rounded-lg border-2 border-slate-200 text-center hover:border-orange-300 transition">
                  <div class="text-lg mb-1">📢</div>
                  <div class="text-xs font-medium">Loud</div>
                  <div class="text-xs text-slate-500">Level 4</div>
                </div>
              </label>
              <label class="relative cursor-pointer">
                <input type="radio" name="noiseLevel" value="5" class="sr-only" />
                <div
                  class="noise-level-option p-3 rounded-lg border-2 border-slate-200 text-center hover:border-red-300 transition">
                  <div class="text-lg mb-1">🚨</div>
                  <div class="text-xs font-medium">Very Loud</div>
                  <div class="text-xs text-slate-500">Level 5</div>
                </div>
              </label>
            </div>
          </div>

          <!-- Location -->
          <div>
            <label for="location" class="block text-sm font-medium text-slate-700 mb-2">Location</label>
            <select id="location" name="location"
              class="w-full rounded-lg border border-slate-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none p-3">
              <option value="">Select location...</option>
              <option value="table-1">Table 1 Area</option>
              <option value="table-2">Table 2 Area</option>
              <option value="table-3">Table 3 Area</option>
              <option value="table-4">Table 4 Area</option>
              <option value="table-5">Table 5 Area</option>
              <option value="table-6">Table 6 Area</option>
              <option value="table-7">Table 7 Area</option>
              <option value="table-8">Table 8 Area</option>
              <option value="table-9">Table 9 Area</option>
              <option value="table-10">Table 10 Area</option>
              <option value="table-11">Table 11 Area</option>
              <option value="table-12">Table 12 Area</option>
              <option value="table-13">Table 13 Area</option>
              <option value="table-14">Table 14 Area</option>
              <option value="table-15">Table 15 Area</option>
              <option value="table-16">Table 16 Area</option>
              <option value="table-17">Table 17 Area</option>
              <option value="table-18">Table 18 Area</option>
              <option value="entrance">Entrance Area</option>
              <option value="group-study">Group Study Area</option>
              <option value="other">Other</option>
            </select>
          </div>

          <!-- Noise Type -->
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-3">Type of Noise</label>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-2 sm:gap-3">
              <label class="flex items-center space-x-2 cursor-pointer">
                <input type="checkbox" name="noiseType" value="talking"
                  class="rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" />
                <span class="text-sm">Talking</span>
              </label>
              <label class="flex items-center space-x-2 cursor-pointer">
                <input type="checkbox" name="noiseType" value="music"
                  class="rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" />
                <span class="text-sm">Music</span>
              </label>
              <label class="flex items-center space-x-2 cursor-pointer">
                <input type="checkbox" name="noiseType" value="phone-call"
                  class="rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" />
                <span class="text-sm">Phone Call</span>
              </label>
              <label class="flex items-center space-x-2 cursor-pointer">
                <input type="checkbox" name="noiseType" value="keyboard"
                  class="rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" />
                <span class="text-sm">Keyboard Typing</span>
              </label>
              <label class="flex items-center space-x-2 cursor-pointer">
                <input type="checkbox" name="noiseType" value="footsteps"
                  class="rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" />
                <span class="text-sm">Footsteps</span>
              </label>
              <label class="flex items-center space-x-2 cursor-pointer">
                <input type="checkbox" name="noiseType" value="equipment"
                  class="rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" />
                <span class="text-sm">Equipment</span>
              </label>
            </div>
          </div>

          <!-- Duration -->
          <div>
            <label for="duration" class="block text-sm font-medium text-slate-700 mb-2">Duration</label>
            <select id="duration" name="duration"
              class="w-full rounded-lg border border-slate-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none p-3">
              <option value="">Select duration...</option>
              <option value="less-than-5">Less than 5 minutes</option>
              <option value="5-15">5-15 minutes</option>
              <option value="15-30">15-30 minutes</option>
              <option value="30-60">30-60 minutes</option>
              <option value="more-than-60">More than 1 hour</option>
              <option value="ongoing">Ongoing</option>
            </select>
          </div>

          <!-- Description -->
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-2">Additional Details</label>
            <textarea id="description" rows="4"
              class="w-full rounded-lg border border-slate-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none p-3"
              placeholder="Describe the noise disturbance in detail..."></textarea>

            <!-- Content Validation Warning -->
            <div id="validationWarning" class="validation-warning">
              <div class="validation-warning-header">
                <svg class="validation-warning-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
                <div class="validation-warning-title">Inappropriate Language Detected</div>
              </div>
              <div class="validation-warning-message">
                Your report contains inappropriate language. Please revise it before submitting to maintain a respectful
                environment.
              </div>
              <div class="validation-warning-actions">
                <button type="button" id="editContentBtn" class="btn-edit">Edit Content</button>
                <button type="button" id="dismissWarningBtn" class="btn-dismiss">Dismiss</button>
              </div>
            </div>
          </div>

          <!-- Urgency -->
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-3">Urgency Level</label>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-2 sm:gap-3">
              <label class="relative cursor-pointer">
                <input type="radio" name="urgency" value="low" class="sr-only" />
                <div
                  class="urgency-option p-3 rounded-lg border-2 border-slate-200 text-center hover:border-green-300 transition">
                  <div class="text-lg mb-1">🟢</div>
                  <div class="text-sm font-medium">Low</div>
                  <div class="text-xs text-slate-500">Minor issue</div>
                </div>
              </label>
              <label class="relative cursor-pointer">
                <input type="radio" name="urgency" value="medium" class="sr-only" />
                <div
                  class="urgency-option p-3 rounded-lg border-2 border-slate-200 text-center hover:border-yellow-300 transition">
                  <div class="text-lg mb-1">🟡</div>
                  <div class="text-sm font-medium">Medium</div>
                  <div class="text-xs text-slate-500">Needs attention</div>
                </div>
              </label>
              <label class="relative cursor-pointer">
                <input type="radio" name="urgency" value="high" class="sr-only" />
                <div
                  class="urgency-option p-3 rounded-lg border-2 border-slate-200 text-center hover:border-red-300 transition">
                  <div class="text-lg mb-1">🔴</div>
                  <div class="text-sm font-medium">High</div>
                  <div class="text-xs text-slate-500">Immediate action</div>
                </div>
              </label>
            </div>
          </div>

          <!-- Submit Button -->
          <div class="flex items-center justify-end gap-3 pt-4 border-t border-slate-200">
            <button type="button" id="cancelBtn" class="px-4 py-2 rounded-lg btn-outline">Cancel</button>
            <button type="submit" id="submitBtn"
              class="px-6 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white font-medium">Submit Report</button>
          </div>
        </form>
      </section>

      <!-- Community Reports (user-facing list) -->
      <!-- This section is designed for community users: card-style items, clear grouping, badges -->
      <section class="card" data-fade data-blur="true" data-duration="1000" data-easing="ease-out" data-delay="150"
        data-initial-opacity="0">
        <div class="flex items-center justify-between mb-4">
          <div>
            <h2 id="community-reports-title" class="text-lg font-semibold">Community Reports</h2>
            <div class="text-xs text-slate-500 mt-0.5"><span id="communityCount">0</span> reports • <span
                id="communityWindow">Last 25</span></div>
          </div>
          <div class="flex items-center gap-2">
            <label for="communityLimit" class="sr-only">Community report count</label>
            <select id="communityLimit" name="communityLimit"
              class="px-2 py-1.5 text-xs rounded-lg border border-slate-300">
              <option value="10">Last 10</option>
              <option value="25" selected>Last 25</option>
              <option value="50">Last 50</option>
            </select>
            <button id="refreshCommunity" class="px-3 py-1.5 text-xs rounded-lg btn-outline">Refresh</button>
          </div>
        </div>
        <div id="communityReports" class="space-y-3">
          <div class="text-center text-slate-500 py-8">
            <p>No community reports yet</p>
            <p class="text-sm">New reports from students will appear here</p>
          </div>
        </div>
      </section>

      <!-- Admin-only Reports Table (hidden for non-admin users) -->
      <!-- Admin view: retains table-like layout for quick scanning. Visibility toggled by role. -->
      <section id="adminReportsTableContainer" class="card hidden" data-fade data-blur="true" data-duration="1000"
        data-easing="ease-out" data-delay="150" data-initial-opacity="0">
        <div class="flex items-center justify-between mb-4">
          <h2 id="admin-reports-title" class="text-lg font-semibold">Admin Reports (table)</h2>
          <div class="text-xs text-slate-500">Visible to admins only</div>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm">
            <thead>
              <tr class="text-left text-slate-500">
                <th class="py-2 pr-4">When</th>
                <th class="py-2 pr-4">Reporter</th>
                <th class="py-2 pr-4">Location</th>
                <th class="py-2 pr-4">Notes</th>
                <th class="py-2 pr-4">Status</th>
              </tr>
            </thead>
            <tbody id="adminReportsTableBody"></tbody>
          </table>
        </div>
      </section>

    </div>
  </main>

  <footer class="footer-glass text-center text-xs py-4" data-fade data-blur="true" data-initial-opacity="0"
    data-duration="1000" data-delay="100">© 2025 UMak Library · Noise Comfort Index</footer>

  <!-- Confirmation Modal -->
  <div id="confirmationModal" class="confirmation-modal-overlay hidden">
    <div class="confirmation-modal">
      <div class="confirmation-modal-header">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
        </svg>
        <h3>Confirm Report Submission</h3>
      </div>
      <div class="confirmation-modal-body">
        <p>Are you sure you want to submit this noise report?</p>
        <div class="warning-text">
          <strong>⚠️ Important Notice:</strong><br>
          If the admin discovers that this report is invalid or falsified, sanctions may apply. Please ensure all
          information provided is accurate and truthful.
        </div>
      </div>
      <div class="confirmation-modal-footer">
        <button type="button" id="cancelConfirmation" class="btn-cancel">Cancel</button>
        <button type="button" id="confirmSubmission" class="btn-confirm">Yes, Submit Report</button>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <div id="successModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center p-4 z-50">
    <div class="bg-white rounded-xl p-6 w-full max-w-md">
      <div class="text-center">
        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
        </div>
        <h3 class="text-lg font-semibold mb-2">Report Submitted</h3>
        <p class="text-slate-600 mb-4">Thank you for helping maintain a quiet study environment. Librarians will review
          your report.</p>
        <button id="closeSuccessModal"
          class="px-4 py-2 rounded-lg bg-green-600 hover:bg-green-700 text-white">OK</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="supabase.js"></script>
  <script src="auth-guard.js"></script>
  <script src="security.js"></script>

  <script>
    (function () {

      // Initialize Supabase
      var supabaseInitialized = false;
      try {
        if (initSupabase()) {
          supabaseInitialized = true;
          console.log('Supabase: Connected');
        } else {
          console.error('Supabase: Error');
        }
      } catch (err) {
        console.error('Supabase: Error', err);
      }

      // Form elements
      var form = document.getElementById('noiseReportForm');
      var cancelBtn = document.getElementById('cancelBtn');
      var submitBtn = document.getElementById('submitBtn');
      var successModal = document.getElementById('successModal');
      var closeSuccessModal = document.getElementById('closeSuccessModal');
      var logoutBtn = document.getElementById('logoutBtn');
      var logoutBtnMobile = document.getElementById('logoutBtnMobile');

      // Logout functionality
      function handleLogout() {
        try {
          if (window.supabaseAuth) {
            window.supabaseAuth.signOut().then(function () {
              window.location.href = 'index.html';
            }).catch(function (err) {
              console.error('Logout error:', err);
              window.location.href = 'index.html';
            });
          } else {
            window.location.href = 'index.html';
          }
        } catch (_) { window.location.href = 'index.html'; }
      }
      if (logoutBtn) { logoutBtn.addEventListener('click', handleLogout); }
      if (logoutBtnMobile) { logoutBtnMobile.addEventListener('click', handleLogout); }

      // Cancel button
      if (cancelBtn) {
        cancelBtn.addEventListener('click', function () {
          window.location.href = 'Frame_11.html';
        });
      }

      // Close success modal (stay on this page)
      if (closeSuccessModal) {
        closeSuccessModal.addEventListener('click', function () {
          successModal.classList.add('hidden');
          successModal.classList.remove('flex');
          try {
            if (form) { form.reset(); }
            if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = 'Submit Report'; }
            loadRecentReports();
          } catch (_) { }
        });
      }

      // Content Validation System
      var validationWarning = document.getElementById('validationWarning');
      var descriptionTextarea = document.getElementById('description');
      var editContentBtn = document.getElementById('editContentBtn');
      var dismissWarningBtn = document.getElementById('dismissWarningBtn');

      // List of restricted words (easily maintainable)
      var restrictedWords = [
        // English profanity and offensive language
        'damn', 'hell', 'crap', 'stupid', 'idiot', 'moron', 'dumb',
        'hate', 'kill', 'die', 'death', 'murder', 'suicide',
        'fuck', 'shit', 'bitch', 'asshole', 'bastard', 'piss',
        'cunt', 'whore', 'slut', 'fag', 'nigger', 'retard',

        // Filipino profanity and offensive language
        'putang', 'puta', 'tangina', 'tang ina', 'tangina mo', 'tang ina mo',
        'gago', 'gaga', 'bobo', 'tanga', 'ulol', 'tarantado', 'tarantadu',
        'hayop', 'hayup', 'buang', 'buang ka', 'buang mo', 'buang ka ba',
        'walang hiya', 'walanghiya', 'bastos', 'malandi', 'pokpok', 'kalapating',
        'bayot', 'bakla', 'tomboy', 'binabae', 'binabai', 'silahis',
        'leche', 'lechugas', 'lechugas mo', 'lechugas ka', 'lechugas mo',
        'sira ulo', 'siraulo', 'sira ang ulo', 'sira ang ulo mo',
        'baliw', 'baliw ka', 'baliw mo', 'nababaliw', 'nababaliw ka',
        'kupal', 'kupal mo', 'kupal ka', 'kupal na', 'kupal na yan',
        'ulol', 'ulol ka', 'ulol mo', 'ulol na', 'ulol na yan',
        'tanga', 'tanga ka', 'tanga mo', 'tanga na', 'tanga na yan',
        'bobo', 'bobo ka', 'bobo mo', 'bobo na', 'bobo na yan',
        'gago', 'gago ka', 'gago mo', 'gago na', 'gago na yan',
        'tarantado', 'tarantadu', 'tarantado ka', 'tarantadu ka',
        'tarantado mo', 'tarantadu mo', 'tarantado na', 'tarantadu na',

        // Filipino threats and violence
        'patayin', 'patayin mo', 'patayin ka', 'papatayin', 'papatayin mo',
        'suntukin', 'suntukin mo', 'suntukin ka', 'susuntukin', 'susuntukin mo',
        'bugbog', 'bugbog mo', 'bugbog ka', 'bubugbog', 'bubugbog mo',
        'sapakin', 'sapakin mo', 'sapakin ka', 'sasapakin', 'sasapakin mo',
        'barilin', 'barilin mo', 'barilin ka', 'babarilin', 'babarilin mo',
        'saksakin', 'saksakin mo', 'saksakin ka', 'sasaksakin', 'sasaksakin mo',
        'bomba', 'bomba mo', 'bomba ka', 'bobomba', 'bobomba mo',
        'siraan', 'siraan mo', 'siraan ka', 'sisiraan', 'sisiraan mo',

        // Filipino inappropriate sexual content
        'kantot', 'kantutan', 'kantutin', 'kantutin mo', 'kantutin ka',
        'jakol', 'jakulin', 'jakulin mo', 'jakulin ka', 'jajakulin',
        'titi', 'pepe', 'kiki', 'burat', 'tamod', 'tamod mo',
        'libog', 'libog mo', 'libog ka', 'nalilibog', 'nalilibog ka',
        'malibog', 'malibog mo', 'malibog ka', 'malibog na', 'malibog na yan',
        'manyak', 'manyak mo', 'manyak ka', 'manyak na', 'manyak na yan',
        'bastos', 'bastos mo', 'bastos ka', 'bastos na', 'bastos na yan',
        'malandi', 'malandi mo', 'malandi ka', 'malandi na', 'malandi na yan',
        'pokpok', 'pokpok mo', 'pokpok ka', 'pokpok na', 'pokpok na yan',
        'kalapating', 'kalapating mo', 'kalapating ka', 'kalapating na',

        // Filipino discrimination and harassment
        'bayot', 'bayot mo', 'bayot ka', 'bayot na', 'bayot na yan',
        'bakla', 'bakla mo', 'bakla ka', 'bakla na', 'bakla na yan',
        'tomboy', 'tomboy mo', 'tomboy ka', 'tomboy na', 'tomboy na yan',
        'binabae', 'binabai', 'binabae mo', 'binabai mo', 'binabae ka', 'binabai ka',
        'silahis', 'silahis mo', 'silahis ka', 'silahis na', 'silahis na yan',
        'walang hiya', 'walanghiya', 'walang hiya mo', 'walanghiya mo',
        'walang hiya ka', 'walanghiya ka', 'walang hiya na', 'walanghiya na',

        // Threats and violence (English)
        'threat', 'threaten', 'violence', 'fight', 'beat', 'hit',
        'punch', 'stab', 'shoot', 'bomb', 'explode', 'destroy',

        // Inappropriate sexual content (English)
        'sex', 'sexual', 'porn', 'pornography', 'masturbat', 'rape',
        'molest', 'pedophil', 'incest', 'orgasm', 'penis', 'vagina',

        // Discrimination and harassment (English)
        'racist', 'racism', 'discriminat', 'harass', 'bully', 'intimidat',
        'sexist', 'homophob', 'transphob', 'xenophob',

        // Spam and inappropriate content
        'spam', 'scam', 'fraud', 'cheat', 'steal', 'rob', 'theft'
      ];

      // Function to check for inappropriate content
      function validateContent(text) {
        if (!text || text.trim().length === 0) return { isValid: true, foundWords: [] };

        var lowerText = text.toLowerCase();
        var foundWords = [];

        // Check for restricted words
        for (var i = 0; i < restrictedWords.length; i++) {
          var word = restrictedWords[i];
          if (lowerText.includes(word)) {
            foundWords.push(word);
          }
        }

        return {
          isValid: foundWords.length === 0,
          foundWords: foundWords
        };
      }

      // Function to show validation warning
      function showValidationWarning() {
        validationWarning.classList.add('show');
        descriptionTextarea.classList.add('textarea-invalid');
        descriptionTextarea.focus();

        // Scroll to warning if needed
        validationWarning.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }

      // Function to hide validation warning
      function hideValidationWarning() {
        validationWarning.classList.remove('show');
        descriptionTextarea.classList.remove('textarea-invalid');
      }

      // Real-time validation on textarea input
      if (descriptionTextarea) {
        descriptionTextarea.addEventListener('input', function () {
          var text = this.value;
          var validation = validateContent(text);

          if (!validation.isValid) {
            showValidationWarning();
          } else {
            hideValidationWarning();
          }
        });

        // Also validate on blur (when user leaves the field)
        descriptionTextarea.addEventListener('blur', function () {
          var text = this.value;
          var validation = validateContent(text);

          if (!validation.isValid) {
            showValidationWarning();
          }
        });
      }

      // Warning action buttons
      if (editContentBtn) {
        editContentBtn.addEventListener('click', function () {
          descriptionTextarea.focus();
          descriptionTextarea.select();
        });
      }

      if (dismissWarningBtn) {
        dismissWarningBtn.addEventListener('click', function () {
          hideValidationWarning();
        });
      }

      // Form submission via Supabase (send to admins)
      if (form) {
        form.addEventListener('submit', async function (e) {
          e.preventDefault();

          // Get form data
          var noiseLevel = document.querySelector('input[name="noiseLevel"]:checked');
          var location = document.getElementById('location').value;
          var noiseTypes = Array.from(document.querySelectorAll('input[name="noiseType"]:checked')).map(function (cb) { return cb.value; });
          var duration = document.getElementById('duration').value;
          var description = document.getElementById('description').value;
          var urgency = document.querySelector('input[name="urgency"]:checked');

          // Basic form validation
          if (!noiseLevel) { alert('Please select a noise level'); return; }
          if (!location) { alert('Please select a location'); return; }
          if (noiseTypes.length === 0) { alert('Please select at least one noise type'); return; }
          if (!duration) { alert('Please select duration'); return; }
          if (!urgency) { alert('Please select urgency level'); return; }

          // Content validation - check for inappropriate language
          var contentValidation = validateContent(description);
          if (!contentValidation.isValid) {
            showValidationWarning();
            alert('Your report contains inappropriate language. Please revise it before submitting.');
            return;
          }

          // Show confirmation modal
          var confirmationModal = document.getElementById('confirmationModal');
          confirmationModal.classList.remove('hidden');

          // Wait for user confirmation
          return; // Don't submit yet
        });

        // Handle confirmation modal
        var confirmationModal = document.getElementById('confirmationModal');
        var cancelConfirmation = document.getElementById('cancelConfirmation');
        var confirmSubmission = document.getElementById('confirmSubmission');

        // Cancel button - hide modal
        cancelConfirmation.addEventListener('click', function () {
          confirmationModal.classList.add('hidden');
        });

        // Confirm button - actually submit the form
        confirmSubmission.addEventListener('click', async function () {
          // Hide confirmation modal
          confirmationModal.classList.add('hidden');

          // Get form data again
          var noiseLevel = document.querySelector('input[name="noiseLevel"]:checked');
          var location = document.getElementById('location').value;
          var noiseTypes = Array.from(document.querySelectorAll('input[name="noiseType"]:checked')).map(function (cb) { return cb.value; });
          var duration = document.getElementById('duration').value;
          var description = document.getElementById('description').value;
          var urgency = document.querySelector('input[name="urgency"]:checked');

          // Final content validation before submission
          var contentValidation = validateContent(description);
          if (!contentValidation.isValid) {
            showValidationWarning();
            alert('Your report contains inappropriate language. Please revise it before submitting.');
            return;
          }

          submitBtn.disabled = true;
          submitBtn.textContent = 'Submitting...';

          try {
            var userResult = await window.supabaseAuth.getCurrentUser();
            var user = userResult && userResult.data ? userResult.data.user : null;
            if (!user) { window.location.href = 'index.html'; return; }

            var tableId = location.indexOf('table-') === 0 ? location : null;
            var notes = '[Types] ' + noiseTypes.join(', ') + ' | [Duration] ' + duration + ' | [Urgency] ' + urgency.value + (description ? (' | [Notes] ' + description) : '');

            // Persist report in noise_logs for admin visibility
            var addRes = await window.supabaseDB.addNoiseLog(user.id, tableId || location, parseFloat(noiseLevel.value), 'report', notes);
            if (addRes && addRes.error) throw addRes.error;

            // Notify admins via alerts table
            var msg = 'New report (' + severityLabel(parseFloat(noiseLevel.value)) + ') at ' + (tableId || location);
            try { await window.supabaseDB.addAlert(user.id, 'report', msg); } catch (_) { }

            successModal.classList.remove('hidden');
            successModal.classList.add('flex');
          } catch (err) {
            console.error('Failed to submit report:', err);
            alert('Failed to submit report. Please try again.');
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Report';
          }

          function severityLabel(level) {
            if (level >= 4.5) return 'critical';
            if (level >= 3) return 'warning';
            return 'info';
          }
        });
      }

      // Close modal when clicking outside
      if (confirmationModal) {
        confirmationModal.addEventListener('click', function (e) {
          if (e.target === confirmationModal) {
            confirmationModal.classList.add('hidden');
          }
        });
      }

      // Visual feedback for radio buttons
      function setupRadioVisuals() {
        // Noise level options
        var noiseLevels = document.querySelectorAll('input[name="noiseLevel"]');
        noiseLevels.forEach(function (radio) {
          radio.addEventListener('change', function () {
            // Remove previous selections
            document.querySelectorAll('.noise-level-option').forEach(function (option) {
              option.classList.remove('border-indigo-500', 'bg-indigo-50');
              option.classList.add('border-slate-200');
            });
            // Add selection to current
            if (this.checked) {
              var option = this.parentElement.querySelector('.noise-level-option');
              option.classList.remove('border-slate-200');
              option.classList.add('border-indigo-500', 'bg-indigo-50');
            }
          });
        });

        // Urgency options
        var urgencies = document.querySelectorAll('input[name="urgency"]');
        urgencies.forEach(function (radio) {
          radio.addEventListener('change', function () {
            // Remove previous selections
            document.querySelectorAll('.urgency-option').forEach(function (option) {
              option.classList.remove('border-indigo-500', 'bg-indigo-50');
              option.classList.add('border-slate-200');
            });
            // Add selection to current
            if (this.checked) {
              var option = this.parentElement.querySelector('.urgency-option');
              option.classList.remove('border-slate-200');
              option.classList.add('border-indigo-500', 'bg-indigo-50');
            }
          });
        });
      }

      // Load community reports via RPC
      function loadCommunityReports() {
        var list = document.getElementById('communityReports');
        var countEl = document.getElementById('communityCount');
        var windowEl = document.getElementById('communityWindow');
        var limitSel = document.getElementById('communityLimit');
        if (!supabaseInitialized || !list) return;
        var limit = 25;
        try { limit = parseInt(limitSel && limitSel.value || '25', 10) || 25; } catch (_) { }
        if (windowEl) { windowEl.textContent = 'Last ' + limit; }
        list.innerHTML = '<div class="text-center text-slate-500 py-6 text-sm">Loading…</div>';
        window.supabaseDB.publicListReports(limit).then(function (result) {
          var rows = Array.isArray(result.data) ? result.data : [];
          if (countEl) { countEl.textContent = String(rows.length); }
          if (rows.length === 0) {
            list.innerHTML = '\n            <div class="text-center text-slate-500 py-8">\n              <p>No community reports yet</p>\n              <p class="text-sm">New reports from students will appear here</p>\n            </div>\n          ';
            return;
          }
          list.innerHTML = '';
          rows.forEach(function (r) {
            var isAdminPost = r.notes && r.notes.toLowerCase().includes('posted by admin');
            var urgency = (function () {
              var m = (r.notes || '').match(/\[Urgency\]\s*(\w+)/i); return m ? (m[1] || '').toLowerCase() : '';
            })();
            var types = (function () {
              var m = (r.notes || '').match(/\[Types\]\s*([^|]+)/i); return m ? (m[1] || '').trim() : '';
            })();
            var duration = (function () {
              var m = (r.notes || '').match(/\[Duration\]\s*([^|]+)/i); return m ? (m[1] || '').trim() : '';
            })();

            var badgeClass = urgency === 'high' ? 'badge badge-high' : (urgency === 'medium' ? 'badge badge-medium' : 'badge badge-low');
            var who = (r.reporter_email || '').trim();
            var when = new Date(r.created_at).toLocaleString();
            var where = r.location || r.table_id || '—';
            var notes = (r.notes || '').replace(/\s*\[Types\][^|]+\|?\s*/i, '').replace(/\s*\[Duration\][^|]+\|?\s*/i, '').replace(/\s*\[Urgency\][^|]+\|?\s*/i, '').trim();

            var el = document.createElement('div');
            el.className = 'report-card p-3 sm:p-4';
            el.innerHTML = '\n              <div class="flex items-start justify-between gap-3">\n                <div class="min-w-0">\n                  <div class="flex items-center gap-2 flex-wrap">\n                    ' + (isAdminPost ? '<span class="badge badge-medium">Admin</span>' : '') + '\n                    <span class="meta-sm">' + (who || 'Reporter') + '</span>\n                    <span class="meta-sm">•</span>\n                    <span class="meta-sm">' + when + '</span>\n                  </div>\n                  <div class="mt-1 text-sm">' + where + '</div>\n                  <div class="mt-2 flex items-center gap-2 flex-wrap">\n                    ' + (urgency ? '<span class="' + badgeClass + '">Urgency: ' + urgency.charAt(0).toUpperCase() + urgency.slice(1) + '</span>' : '') + '\n                    ' + (types ? '<span class="badge" style="background:rgba(59,130,246,0.12);color:#1d4ed8">' + types + '</span>' : '') + '\n                    ' + (duration ? '<span class="badge" style="background:rgba(107,114,128,0.12);color:#374151">' + duration + '</span>' : '') + '\n                  </div>\n                  ' + (notes ? '<div class="mt-2 text-sm text-slate-700">' + notes + '</div>' : '') + '\n                </div>\n              </div>\n            ';
            list.appendChild(el);
          });
        }).catch(function () {
          list.innerHTML = '<div class="text-center text-red-600 py-6 text-sm">Failed to load community reports.</div>';
        });
      }

      // Load community reports immediately (no auth gate needed to view)
      if (supabaseInitialized) {
        loadCommunityReports();
        var limitSel = document.getElementById('communityLimit');
        var refreshBtn = document.getElementById('refreshCommunity');
        if (limitSel) limitSel.addEventListener('change', loadCommunityReports);
        if (refreshBtn) refreshBtn.addEventListener('click', loadCommunityReports);

        // Role-based visibility: show admin table if admin
        try {
          window.supabaseAuth.getCurrentUser().then(function (res) {
            var user = res && res.data ? res.data.user : null;
            if (!user) return;
            window.supabaseDB.isAdmin(user.id).then(function (chk) {
              var isAdmin = chk && chk.data === true;
              var adminCt = document.getElementById('adminReportsTableContainer');
              if (adminCt) {
                if (isAdmin) {
                  adminCt.classList.remove('hidden');
                  // Populate admin table
                  window.supabaseDB.getNoiseLogs('*', 50).then(function (res2) {
                    var rows = Array.isArray(res2.data) ? res2.data : [];
                    var tbody = document.getElementById('adminReportsTableBody');
                    if (tbody) {
                      tbody.innerHTML = '';
                      rows.forEach(function (r) {
                        var tr = document.createElement('tr');
                        tr.innerHTML = '<td class="py-2 pr-4">' + (new Date(r.created_at).toLocaleString()) + '</td>' +
                          '<td class="py-2 pr-4">' + (r.reporter_email || '') + '</td>' +
                          '<td class="py-2 pr-4">' + (r.location || r.table_id || '—') + '</td>' +
                          '<td class="py-2 pr-4">' + (r.notes || '') + '</td>' +
                          '<td class="py-2 pr-4">' + (r.status || '') + '</td>';
                        tbody.appendChild(tr);
                      });
                    }
                  }).catch(function () { });
                } else {
                  adminCt.classList.add('hidden');
                }
              }
            });
          });
        } catch (_) { }
      }

      // Initialize
      setupRadioVisuals();
    })();
  </script>
  <script>
    // Fade-on-scroll transitions (match other frames to avoid sticky blur)
    (function () {
      var fadeElements = Array.from(document.querySelectorAll('[data-fade]'));
      if (fadeElements.length === 0) return;

      fadeElements.forEach(function (el) {
        var initialOpacity = parseFloat(el.getAttribute('data-initial-opacity') || '0');
        var duration = parseInt(el.getAttribute('data-duration') || '1000', 10);
        var easing = el.getAttribute('data-easing') || 'ease-out';
        var blurPxAttr = el.getAttribute('data-blur-px');
        var blurPx = parseInt(blurPxAttr || '14', 10);
        el.style.opacity = String(initialOpacity);
        el.style.setProperty('--fade-init', blurPx + 'px');
        el.style.setProperty('--fade-transition', 'opacity ' + duration + 'ms ' + easing + ', filter ' + duration + 'ms ' + easing);
      });

      var observer = new IntersectionObserver(function (entries) {
        entries.forEach(function (entry) {
          if (entry.isIntersecting) {
            var el = entry.target;
            var delay = parseInt(el.getAttribute('data-delay') || '0', 10);
            var blurAttr = el.getAttribute('data-blur');
            var blurEnabled = (blurAttr !== 'false');
            observer.unobserve(el);
            setTimeout(function () {
              el.style.opacity = '1';
              if (blurEnabled) {
                el.style.setProperty('--fade-init', '0px');
              }
            }, delay);
          }
        });
      }, { threshold: 0.1 });

      fadeElements.forEach(function (el) { observer.observe(el); });
    })();
  </script>
  <script>
    // Fade-on-scroll transitions (same as Frame 8)
    (function () {
      var fadeElements = Array.from(document.querySelectorAll('[data-fade]'));
      if (fadeElements.length === 0) return;

      fadeElements.forEach(function (el) {
        var initialOpacity = parseFloat(el.getAttribute('data-initial-opacity') || '0');
        var duration = parseInt(el.getAttribute('data-duration') || '1000', 10);
        var easing = el.getAttribute('data-easing') || 'ease-out';
        var blurAttr = el.getAttribute('data-blur');
        var blurEnabled = (blurAttr !== 'false');
        el.style.opacity = String(initialOpacity);
        el.style.filter = blurEnabled ? 'blur(10px)' : 'none';
        el.style.transition = 'opacity ' + duration + 'ms ' + easing + ', filter ' + duration + 'ms ' + easing;
      });

      var observer = new IntersectionObserver(function (entries) {
        entries.forEach(function (entry) {
          if (entry.isIntersecting) {
            var el = entry.target;
            var delay = parseInt(el.getAttribute('data-delay') || '0', 10);
            var blurAttr = el.getAttribute('data-blur');
            var blurEnabled = (blurAttr !== 'false');
            observer.unobserve(el);
            setTimeout(function () {
              el.style.opacity = '1';
              if (blurEnabled) {
                el.style.filter = 'blur(0px)';
              }
            }, delay);
          }
        });
      }, { threshold: 0.1 });

      fadeElements.forEach(function (el) { observer.observe(el); });
    })();
  </script>
  <script>
    // Mobile menu toggle for Frame 16 (robust)
    (function () {
      try {
        var mobileBtn = document.getElementById('mobile-menu-btn');
        var mobileMenu = document.getElementById('mobile-menu');
        var header = document.querySelector('header.site-header');
        if (mobileBtn && mobileMenu && header) {
          mobileBtn.addEventListener('click', function () {
            var isHidden = mobileMenu.classList.contains('hidden');
            if (isHidden) {
              header.classList.add('menu-open');
              mobileMenu.classList.remove('hidden');
              mobileBtn.setAttribute('aria-expanded', 'true');
            } else {
              header.classList.remove('menu-open');
              mobileMenu.classList.add('hidden');
              mobileBtn.setAttribute('aria-expanded', 'false');
            }
          });
        }
      } catch (_) { }
    })();
  </script>

  <style>
    .noise-level-option:hover {
      transform: translateY(-1px);
    }

    .urgency-option:hover {
      transform: translateY(-1px);
    }
  </style>
  <script>
    // Library-themed cursor follower
    (function () {
      const follower = document.getElementById('cursor-follower');
      if (!follower) return;

      // Hide on touch devices
      const isTouch = ('ontouchstart' in window) || navigator.maxTouchPoints > 0;
      if (isTouch) { follower.style.display = 'none'; return; }
      if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        follower.style.display = 'none'; return;
      }

      let mouseX = window.innerWidth / 2;
      let mouseY = window.innerHeight / 2;
      let posX = mouseX;
      let posY = mouseY;
      const ease = 0.08; // Slower, more gentle movement for library theme
      let isVisible = false;

      // Gentle fade in/out on mouse movement
      window.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        if (!isVisible) {
          follower.style.opacity = '0.6';
          isVisible = true;
        }
      }, { passive: true });

      // Fade out when mouse leaves window
      window.addEventListener('mouseleave', () => {
        follower.style.opacity = '0';
        isVisible = false;
      });

      // Smooth following animation
      function animate() {
        posX += (mouseX - posX) * ease;
        posY += (mouseY - posY) * ease;
        follower.style.transform = `translate(${posX}px, ${posY}px) translate(-50%, -50%)`;
        requestAnimationFrame(animate);
      }
      requestAnimationFrame(animate);
    })();

    // Initialize Lucide icons
    if (typeof lucide !== 'undefined') {
      lucide.createIcons();
    }
  </script>
</body>

</html>